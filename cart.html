
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="Web-Development Agency, - Optimise Your Business Today, with your very Own Website - 100% Ownership.">
  <meta name="keywords" content="HTML, CSS, JavaScript, Website, Web-Development, OptiBiz, Optibiz, optibiz, optibiz.agency, Optibiz.agency, OptiBiz.agency">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#000000"><!-- Sets the theme color for Android browsers -->
  <meta name="apple-mobile-web-app-status-bar-style" content="black"><!-- For iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="icon" href="photos/OBNEWINLINEWHITE.png" type="image/png">
  <link rel="stylesheet" href="cart.css">
  <title>OptiBiz | Shopping Cart</title>
  

<script src="https://kit.fontawesome.com/e312fcd33f.js" crossorigin="anonymous"></script>

   <!-- Include Stripe.js -->
  <script src="https://js.stripe.com/v3/"></script>

  
  <script>
    function loadCart() {
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  const cartContainer = document.getElementById('cart-container');
  const cartSummary = document.getElementById('cart-summary');
  cartContainer.innerHTML = '';

  if (cart.length === 0) {
    cartContainer.innerHTML = `
      <div class="empty-cart-message">
        <p>Your cart is empty. Add items using the button below.</p>
        <a href="course.html">Go to Course Page</a>
      </div>
    `;
    cartSummary.innerHTML = '';
    return;
  }

  let itemCounts = {};
  cart.forEach(item => {
    itemCounts[item] = (itemCounts[item] || 0) + 1;
  });

     let total = 0;
      const itemPrices = {
        'Course (Templates)': 149,
        'Website Development (No payment Gateway)': 799,
        'Website Development (Payment Gateway)': 999,
        'Marketing Strategy': 999,
        'SEO Services': 999

  };

  for (let [item, count] of Object.entries(itemCounts)) {
    const itemBox = document.createElement('div');
    itemBox.classList.add('course-box');
      total += (itemPrices[item] || 0) * count;

    itemBox.innerHTML = `
      <h2>${item} ${count > 1 ? `x${count}` : ''}</h2>
      <button class="remove-from-cart-btn" onclick="removeFromCart('${item}')">Remove</button>
    `;
    cartContainer.appendChild(itemBox);
  }

  cartSummary.innerHTML = `
    <p>Total: Â£${total.toFixed(2)}</p>
    <button class="add-to-cart-btn" onclick="proceedToCheckout()">Proceed to Checkout</button>
  `;
}

function removeFromCart(item) {
  let cart = JSON.parse(localStorage.getItem('cart')) || [];
  cart = cart.filter(cartItem => cartItem !== item);
  localStorage.setItem('cart', JSON.stringify(cart));
  loadCart();
}

async function proceedToCheckout() {
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      let itemCounts = {};
      cart.forEach(item => {
        itemCounts[item] = (itemCounts[item] || 0) + 1;
      });

      let items = [];
      const itemPrices = {
        'Course (Templates)': 14900, // Stripe amounts are in cents
        'Website Development (No payment Gateway)': 79900,
        'Website Development (Payment Gateway)': 99900,
        'Marketing Strategy': 99900,
        'SEO Services': 99900
      };

      for (let [item, count] of Object.entries(itemCounts)) {
        items.push({
          price_data: {
            currency: 'gbp',
            product_data: {
              name: item,
            },
            unit_amount: itemPrices[item] || 0,
          },
          quantity: count,
        });
      }

      const response = await fetch('/create-checkout-session', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ items }),
      });

      const session = await response.json();

      const stripe = Stripe('pk_live_51PqLhOFDR0ud356M7EymBKLS9Lwr1DCA8YZDKyc3LrxvfmilhSJiO4re9oYy3INOmgRaEhQBJvIuJ5DG6Zpcl0Gx00W1GMJLua'); // Replace with your Stripe publishable key
      stripe.redirectToCheckout({ sessionId: session.id });
    }

    window.onload = loadCart;
  </script>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-left">
        <h1>
            <img src="photos/OBNEWINLINEWHITE.png" alt="OptiBiz Logo" style="height: 35px;">
        </h1>
      </div>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="course.html">Course</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="reviews.html">Reviews</a></li>
        </ul>
      </nav>
    </header>

    <section class="hero-section">
      <div id="cart-container" class="courses-container">
        <!-- Cart items will be loaded here -->
      </div>
      <div id="cart-summary" class="cart-summary">
        <!-- Cart summary will be displayed here -->
      </div>
    </section>

    <footer>
        <p>&copy; 2024 OptiBiz Agency | All rights reserved | <a href="termsofservice.html">Terms of Service</a></p>
        <div class="social-icons">
          <a href="https://www.instagram.com/optibiz.agency?igsh=MWE2M" target="_blank" class="fab fa-instagram"></a>
          <a href="https://x.com/opti_biz?s=21&t=O8WMIBNZqK8JX4ZdaXMtOw" target="_blank" class="fab fa-x-twitter"></a>
        </div>
      </footer>
    </div>
  </body>
  </html>
